<!doctype html>
<html>
<head>
  <title>Teacher â€“ Generate QR</title>
  <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.1/build/qrcode.min.js"></script>
</head>
<body>
  <h2>Generate Attendance QR</h2>
  <button onclick="generateQR()">Generate QR</button>
  <div id="qr"></div>

<script>
function generateQR() {
  const sessionId = Date.now().toString();
  const expiry = Date.now() + 10 * 60 * 1000; // 10 minutes

  localStorage.setItem("sessionId", sessionId);
  localStorage.setItem("expiry", expiry);
  localStorage.setItem("records", JSON.stringify([]));

  const payload = encodeURIComponent(JSON.stringify({ sessionId, expiry }));
  const url = `attendance.html?data=${payload}`;

  document.getElementById("qr").innerHTML = "";
  QRCode.toCanvas(url, { width: 220 }, (_, c) =>
    document.getElementById("qr").appendChild(c)
  );
}
</script>
</body>
</html>
