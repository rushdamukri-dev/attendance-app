<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Attendance Summary â€” Today</title>
<style>
  body { font-family: Arial, sans-serif; margin: 2em; background:#fafafa; }
  h2 { color:#333; margin-bottom:0.2em; }
  p { color:#555; margin-bottom:1em; }
  table { border-collapse: collapse; width: 100%; background:white; box-shadow:0 2px 4px rgba(0,0,0,0.05); }
  th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
  th { background: #f3f3f3; }
  tr:nth-child(even) { background: #f9f9f9; }
  .no-data { color:#999; text-align:center; padding:1em; }
</style>
</head>
<body>
<h2>ðŸ“Š Attendance Summary (Today)</h2>
<p>Showing records from your Google Sheet for <b><span id="today"></span></b>.</p>

<table id="dataTable">
  <thead>
    <tr><th>Timestamp</th><th>Name</th><th>ID</th><th>Status</th></tr>
  </thead>
  <tbody></tbody>
</table>

<script>
const SHEET_ID = "/18sw7g6dy4z83fkvvKerATr7vfST0qWAd6KJgYgZFCSg/";   // Replace with your Sheet ID
const API_KEY = "AIzaSyB123456abcdefXYZ789";     // Replace with your Google API Key
const RANGE = "Sheet1!A2:G";             // Adjust if needed

document.getElementById("today").textContent =
  new Date().toLocaleDateString(undefined, { year: 'numeric', month: 'short', day: 'numeric' });

async function loadData() {
  const url = `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/${RANGE}?key=${API_KEY}`;
  const tbody = document.querySelector("#dataTable tbody");
  tbody.innerHTML = "<tr><td colspan='4' class='no-data'>Loading...</td></tr>";

  try {
    const res = await fetch(url);
    const data = await res.json();
    const values = data.values || [];
    const todayStr = new Date().toISOString().slice(0,10); // e.g. "2025-10-14"

    const todayRows = values.filter(row => row[0]?.startsWith(todayStr));

    tbody.innerHTML = "";

    if (!todayRows.length) {
      tbody.innerHTML = "<tr><td colspan='4' class='no-data'>No attendance yet today.</td></tr>";
      return;
    }

    todayRows.reverse().forEach(row => {
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td>${row[0] || ""}</td>
        <td>${row[1] || ""}</td>
        <td>${row[2] || ""}</td>
        <td>${row[6] || ""}</td>`;
      tbody.appendChild(tr);
    });
  } catch (err) {
    console.error(err);
    tbody.innerHTML = "<tr><td colspan='4' class='no-data'>Error loading data. Check API key and sharing.</td></tr>";
  }
}

loadData();
</script>
</body>
</html>
