<!doctype html>
<html>
<head>
  <title>Summary</title>
</head>
<body>
  <h2>Attendance Summary</h2>
  <div id="list"></div>
  <br>
  <button onclick="downloadCSV()">Download CSV</button>

<script>
const records = JSON.parse(localStorage.getItem("records")) || [];
const list = document.getElementById("list");

if (records.length === 0) {
  list.innerHTML = "<p>No attendance marked</p>";
} else {
  records.forEach(r => {
    list.innerHTML += `<p>${r.roll} - ${r.name} (${r.time})</p>`;
  });
}

function downloadCSV() {
  let csv = "Roll,Name,Time\n";
  records.forEach(r => {
    csv += `${r.roll},${r.name},${r.time}\n`;
  });

  const blob = new Blob([csv], { type: "text/csv" });
  const a = document.createElement("a");
  a.href = URL.createObjectURL(blob);
  a.download = "attendance.csv";
  a.click();
}
</script>
</body>
</html>
