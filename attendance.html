<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Mark Attendance</title>
</head>
<body>

<h2>Student Attendance</h2>

<form id="attendanceForm">
  <label>
    Name:
    <input type="text" id="name" required>
  </label><br><br>

  <label>
    Roll Number:
    <input type="text" id="roll" required>
  </label><br><br>

  <button type="submit">Mark Attendance</button>
</form>
const params = new URLSearchParams(window.location.search);
const token = params.get("token");

if (!token) {
  alert("Invalid access. Please scan QR.");
  window.location.href = "./teacher.html";
}
// STEP 3C â€” QR TIME EXPIRY CHECK
if (Date.now() - payload.timestamp > 10 * 60 * 1000) {
  alert("QR expired. Ask teacher to generate a new one.");
  window.location.href = "./teacher.html";
}

<script>
/* =========================
   1. QR TOKEN VALIDATION
========================= */
const params = new URLSearchParams(window.location.search);
const token = params.get("token");

if (!token) {
  alert("Invalid access. Please scan QR.");
 window.location.href = "./teacher.html";

}

let payload;
try {
  payload = JSON.parse(decodeURIComponent(token));
} catch {
  alert("Invalid QR data");
  window.location.href = "./teacher.html";

}

const storedSession = localStorage.getItem("sessionId");
const expiry = localStorage.getItem("expiry");

if (
  payload.session !== storedSession ||
  Date.now() > expiry
) {
  alert("Attendance session expired");
 window.location.href = "./teacher.html";

}

/* =========================
   2. DUPLICATE PREVENTION
========================= */
let records = JSON.parse(localStorage.getItem("records")) || [];
let marked = JSON.parse(localStorage.getItem("marked")) || [];

/* =========================
   3. FORM SUBMISSION
========================= */
document.getElementById("attendanceForm").addEventListener("submit", (e) => {
  e.preventDefault();

  const name = document.getElementById("name").value.trim();
  const roll = document.getElementById("roll").value.trim().toUpperCase();

  i



